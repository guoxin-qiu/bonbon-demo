var ue=Object.defineProperty,ce=Object.defineProperties;var fe=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var me=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var F=(e,o,t)=>o in e?ue(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,N=(e,o)=>{for(var t in o||(o={}))me.call(o,t)&&F(e,t,o[t]);if(Y)for(var t of Y(o))pe.call(o,t)&&F(e,t,o[t]);return e},P=(e,o)=>ce(e,fe(o));var T=(e,o,t)=>new Promise((r,l)=>{var s=i=>{try{n(t.next(i))}catch(c){l(c)}},a=i=>{try{n(t.throw(i))}catch(c){l(c)}},n=i=>i.done?r(i.value):Promise.resolve(i.value).then(s,a);n((t=t.apply(e,o)).next())});import{d as V,I as q,o as h,b as G,E as $,W as _e,u as d,t as S,ag as ge,U as w,af as j,am as X,F as Z,T as u,ah as ye,ai as he,p as ee,L as ve,Y as A,K as J,X as E,aP as O,aQ as H,q as te,P as be,e as oe,R as we,l as Se,O as _,a1 as ae,al as Ve,v as xe}from"./vendor0-9e9963e5.js";import{i as D,m as Ce,e as M,f as Re,g as Be,a as le,P as Ee}from"./index-3da9c86c.js";import{r as Ue,v as Oe,w as ke,h as Te,x as De,b as L,f as C,y as z,n as se,o as $e,m as Ne,q as re,z as Le}from"./element-plus-c89972e5.js";import{r as W}from"./vendor1-b25ebc05.js";import"./graphql-9dc7dd56.js";const K=[{id:100100111,code:"ADMIN",name:"管理员",userCount:1,status:"1",statusName:"有效",modifiedBy:"bonbon",modifiedOn:"2024/01/22 18:16:11"},{id:200200221,code:"USER",name:"普通用户",userCount:3,status:"1",statusName:"有效",modifiedBy:"bonbon",modifiedOn:"2024/02/01 11:16:11"},{id:200200222,code:"USER2",name:"普通用户2",userCount:1,status:"2",statusName:"无效",modifiedBy:"bonbon",modifiedOn:"2024/02/01 11:16:11"}];function ze(e){let o=K;return D(e.code)||(o=o.filter(t=>t.code.toLowerCase().includes(e.code.toLowerCase()))),D(e.name)||(o=o.filter(t=>t.name.toLowerCase().includes(e.name.toLowerCase()))),D(e.status)||(o=o.filter(t=>t.status.toLowerCase().includes(e.status.toLowerCase()))),D(e.modifiedBy)||(o=o.filter(t=>t.modifiedBy.toLowerCase().includes(e.modifiedBy.toLowerCase()))),D(e.modifiedOn)||(o=o.filter(t=>t.modifiedOn.toLowerCase().includes(e.modifiedOn.toLowerCase()))),Ce(o)}function Me(e){const o=K.find(t=>t.id==e)||{id:0,code:"",name:"",userCount:0,status:"",statusName:"",modifiedBy:"",modifiedOn:""};return M(o)}function qe(e){if(!e.id)return M(null,!1,"非法的请求");const o=K.find(t=>t.id==e.id);return o?(o.name=e.name,o.status=e.status,M(o)):M(null,!1,"非法的请求")}const He=V({__name:"index",setup(e){const o=q({minHeight:window.innerHeight-90});return window.onresize=()=>{o.minHeight=window.innerHeight-90},(t,r)=>(h(),G("div",{class:"app-container",style:_e({minHeight:d(o).minHeight+"px"})},[$(t.$slots,"default")],4))}}),Ie=V({__name:"index",setup(e,{expose:o}){const t=Re(),r=S();function l(){const a=r.value;return a?a.getCheckboxRecords():[]}function s(){const a=r.value;if(a)return a.commitProxy("query")}return o({getSelectedRows:l,refreshTable:s}),(a,n)=>{const i=ge("vxe-grid");return h(),w(i,Z({size:d(t).vxeGridSize},a.$attrs,{ref_key:"xGridRefPrivate",ref:r}),j({_:2},[X(a.$slots,(c,m)=>({name:m,fn:u(y=>[$(a.$slots,m,ye(he(y)))])}))]),1040,["size"])}}}),Pe=Be(),ne=e=>Pe.dictMap[e],je=V({__name:"index",props:{type:{type:String,required:!0},value:{type:[String,Number,Boolean]}},setup(e){const o=e,t=S(),r=(l,s)=>{const a=ne(l);!a||!s?t.value=void 0:a.forEach(n=>{n.value===s&&(t.value=n)})};return ee(()=>{var l;return r(o.type,(l=o.value)==null?void 0:l.toString())}),ve(()=>{var l;r(o.type,(l=o.value)==null?void 0:l.toString())}),(l,s)=>{var n,i,c,m,y,v,g,f,R,x;const a=Ue;return((n=d(t))==null?void 0:n.colorType)==="default"||((i=d(t))==null?void 0:i.colorType)===""||((c=d(t))==null?void 0:c.colorType)===void 0?(h(),G("span",{key:(m=d(t))==null?void 0:m.value.toString(),class:J((y=d(t))==null?void 0:y.cssClass)},A((v=d(t))==null?void 0:v.text),3)):(h(),w(a,{"disable-transitions":!0,key:((g=d(t))==null?void 0:g.value)+"",type:((f=d(t))==null?void 0:f.colorType)==="primary"?"success":(R=d(t))==null?void 0:R.colorType,class:J((x=d(t))==null?void 0:x.cssClass)},{default:u(()=>{var U;return[E(A((U=d(t))==null?void 0:U.text),1)]}),_:1},8,["type","class"]))}}}),Ae={style:{float:"left"}},Ge=V({__name:"index",props:O({placeholder:{},multiple:{type:Boolean},disabled:{type:Boolean},clearable:{type:Boolean},data:{},queryApi:{type:Function}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const o=H(e,"modelValue"),t=e,r=S([]);return te(()=>T(this,null,function*(){if(t.queryApi){const l=yield t.queryApi();r.value=l.data}else t.data?r.value=t.data:r.value=[]})),(l,s)=>{const a=Oe,n=ke;return h(),w(n,{clearable:t.clearable,modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=i=>o.value=i),placeholder:t.placeholder||"",disabled:t.disabled,multiple:t.multiple,"no-data-text":"暂无数据"},{default:u(()=>[(h(!0),G(be,null,X(d(r),i=>(h(),w(a,{key:i.value+"",label:`${i.text}`,value:i.value},{default:u(()=>[oe("span",Ae,A(i.text),1)]),_:2},1032,["label","value"]))),128))]),_:1},8,["clearable","modelValue","placeholder","disabled","multiple"])}}}),ie=V({__name:"index",props:O({type:{type:String,required:!0},placeholder:{type:String},multiple:{type:Boolean},disabled:{type:Boolean},clearable:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const o=H(e,"modelValue"),t=e,r=S([]);return ee(()=>{var l;r.value=((l=ne(t.type))==null?void 0:l.map(s=>({value:s.value+"",text:s.text})))||[]}),(l,s)=>{const a=Ge;return h(),w(a,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=n=>o.value=n),data:d(r),placeholder:t.placeholder||"",multiple:t.multiple,disabled:t.disabled,clearable:t.clearable},null,8,["modelValue","data","placeholder","multiple","disabled","clearable"])}}}),Ke={class:"dialog-footer"},Ye=V({__name:"index",props:O({title:{type:String,required:!0,default:""},size:{type:String,required:!1,default:"Middle"},fullscreen:{type:Boolean,required:!1,default:!1}},{modelValue:{type:Boolean,required:!1,default:!1},modelModifiers:{}}),emits:O(["close"],["update:modelValue"]),setup(e){const o=H(e,"modelValue"),t=e,r=we(),l=q({maxHeight:window.innerHeight*.5+"px"});window.onresize=()=>{l.maxHeight=window.innerHeight*.5+"px"};const s=Se(()=>{switch(t.size){case"full":return"98%";case"normal":return"80%";case"middle":return"50%";case"small":return"30%";default:return"60%"}});return(a,n)=>{const i=Te,c=De;return h(),w(c,{onClose:n[0]||(n[0]=m=>a.$emit("close")),modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=m=>o.value=m),title:t.title,width:d(s),fullscreen:t.fullscreen,"close-on-click-modal":!1,"close-on-press-escape":!1,"append-to-body":"",top:"6%"},j({default:u(()=>[_(i,{"max-height":d(l).maxHeight},j({_:2},[d(r).default?{name:"default",fn:u(()=>[$(a.$slots,"default",{},void 0,!0)]),key:"0"}:void 0]),1032,["max-height"])]),_:2},[d(r).header?{name:"header",fn:u(()=>[$(a.$slots,"header",{},void 0,!0)]),key:"0"}:void 0,d(r).footer?{name:"footer",fn:u(()=>[oe("span",Ke,[$(a.$slots,"footer",{},void 0,!0)])]),key:"1"}:void 0]),1032,["modelValue","title","width","fullscreen"])}}});const Fe=le(Ye,[["__scopeId","data-v-9c456a39"]]),de=()=>({info(e){L.info({message:e,showClose:!0})},error(e){L.error({message:e,showClose:!0})},success(e){L.success({message:e,showClose:!0})},warning(e){L.warning({message:e,showClose:!0})},alert(e){C.alert(e,"系统提示")},alertError(e){C.alert(e,"系统提示",{type:"error"})},alertSuccess(e){C.alert(e,"系统提示",{type:"success"})},alertWarning(e){C.alert(e,"系统提示",{type:"warning"})},notify(e){z.info(e)},notifyError(e){z.error(e)},notifySuccess(e){z.success(e)},notifyWarning(e){z.warning(e)},confirm(e,o){return C.confirm(e,o||"系统提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})},delConfirm(e,o){return C.confirm(e||"是否删除数据？",o||"系统提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})},exportConfirm(e,o){return C.confirm(e||"是否确认导出数据项？",o||"系统提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})},prompt(e,o){return C.prompt(e,o,{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"})}}),Je=V({__name:"edit",props:O({dataId:{type:String,default:""}},{modelValue:{type:Boolean,required:!1,default:!1},modelModifiers:{}}),emits:O(["refresh"],["update:modelValue"]),setup(e,{emit:o}){const t=e,r=o,l=H(e,"modelValue"),s=de(),a=S(!1),n=S(!1),i={id:0,code:"",name:"",userCount:0,status:"",statusName:"",modifiedBy:"",modifiedOn:""},c=S(i);function m(g){return T(this,null,function*(){try{a.value=!0;const f=yield Me(Number(g));f.success?c.value=f.data:s.error(f.message||"数据异常")}catch(f){s.error("系统出现未知异常")}finally{a.value=!1}})}te(()=>{t.dataId!==c.value.id+""&&m(t.dataId)});function y(){return T(this,null,function*(){n.value=!0;const g=yield qe(c.value);g.success?(s.success("保存成功"),v(!0)):s.error(g.message||"保存失败"),n.value=!1})}function v(g){l.value=!1,c.value=i,g&&r("refresh")}return(g,f)=>{const R=se,x=$e,U=ie,I=Ne,k=re,p=Fe,b=Le;return h(),w(p,{modelValue:l.value,"onUpdate:modelValue":f[4]||(f[4]=B=>l.value=B),title:"编辑用户角色信息",onClose:v,size:"middle"},{default:u(()=>[ae((h(),w(I,{ref:"userRoleForm",model:d(c),"label-width":"auto","label-position":"left",class:"form"},{default:u(()=>[_(x,{label:"编码"},{default:u(()=>[_(R,{modelValue:d(c).code,"onUpdate:modelValue":f[0]||(f[0]=B=>d(c).code=B),disabled:""},null,8,["modelValue"])]),_:1}),_(x,{label:"名称"},{default:u(()=>[_(R,{modelValue:d(c).name,"onUpdate:modelValue":f[1]||(f[1]=B=>d(c).name=B)},null,8,["modelValue"])]),_:1}),_(x,{label:"状态"},{default:u(()=>[_(U,{type:"USER_ROLE_STATUS",modelValue:d(c).status,"onUpdate:modelValue":f[2]||(f[2]=B=>d(c).status=B),placeholder:"状态"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])),[[b,d(a)]])]),footer:u(()=>[_(k,{type:"primary",loading:d(n),onClick:y},{default:u(()=>[E("保存")]),_:1},8,["loading"]),_(k,{type:"default",onClick:f[3]||(f[3]=()=>v())},{default:u(()=>[E("关闭")]),_:1})]),_:1},8,["modelValue"])}}});const We=le(Je,[["__scopeId","data-v-d36a5866"]]);function Qe(e,o,t,r){const l={id:e,autoResize:!0,border:!0,round:!0,showOverflow:!0,stripe:!0,seqConfig:{startIndex:1},align:"left",columnConfig:{resizable:!0},customConfig:{storage:!0,checkMethod({column:s}){return!["checkbox","#","operation"].includes(s.field)}},rowConfig:{isCurrent:!1,isHover:!0,keyField:"id"},checkboxConfig:{reserve:!0,highlight:!0,range:!0},pagerConfig:{enabled:!0,total:0,currentPage:1,pageSize:Ee,pageSizes:[2,5,10,20,50,100,200,500]},loading:!1,toolbarConfig:{perfect:!0,refresh:!0,import:!1,export:!1,print:!1,zoom:!0,custom:!0,slots:{buttons:"toolbar_buttons"}},proxyConfig:{seq:!0,sort:!0,filter:!0,form:!0,props:{result:"list",total:"count"},ajax:{query:c=>T(this,[c],function*({page:s,sorts:a,filters:n,form:i}){t&&Object.keys(t).forEach(g=>{i[g]=t[g]}),r&&sessionStorage.setItem(r,JSON.stringify(i));const m=N({},i),y=a[0];return y&&(m.sort=y.field,m.order=y.order),n.forEach(({field:g,values:f})=>{m[g]=f.join(",")}),m.size=s==null?void 0:s.pageSize,m.page=s==null?void 0:s.currentPage,(o?yield o(m):{data:void 0}).data})}},sortConfig:{remote:!0},filterConfig:{remote:!0}};return o||(l.proxyConfig=void 0),l}function Xe(e){return"SF-"+e}function Ze(e,o,t){var s;if(!t)return;if(!o)return t;const r=sessionStorage.getItem(Xe(e)),l=JSON.parse(r||"{}");return Object.keys(l).length===0?((s=t.items)==null||s.forEach(a=>{a.itemRender&&(a.itemRender.defaultValue="")}),t):(Object.keys(l).forEach(a=>{var i;const n=(i=t.items)==null?void 0:i.filter(c=>c.field===a);if(n&&n[0]){const c=n[0];c.itemRender?c.itemRender.defaultValue=l[a]:c.itemRender={defaultValue:l[a]}}}),t)}const et=e=>{const o=q({pageSize:10,currentPage:1,total:0,tableList:[],loading:!0,exportLoading:!1,currentRow:void 0,gridKey:e.gridKey,searchDataCacheKey:"SF-"+e.gridKey}),t=q(P(N({},Qe(e.gridKey,e.getListApi,void 0,e.cacheSearch?o.searchDataCacheKey:void 0)),{columns:e.columns,formConfig:Ze(e.gridKey,e.cacheSearch,e.searchFormConfig)}));return{gridObject:o,gridOptions:t,getSelectedRows:()=>e.ref.value?e.ref.value.getSelectedRows():[],refreshTable:()=>{e.ref.value&&e.ref.value.refreshTable()}}};function Q(e){return!Number.isNaN(Number(e))}function tt(e,o){return Math.round(e*Math.pow(10,o))/Math.pow(10,o)}const ot={date:e=>e&&W(e).format("YYYY-MM-DD"),datetime:e=>e&&W(e).format("YYYY-MM-DD HH:mm:ss"),thousand:(e,o)=>{if(Q(e)){const t=tt(Number(e),o),r=/\d{1,3}(?=(\d{3})+$)/g;return`${t}`.replace(/^([-+]?\d+)((\.\d+)?)$/,function(s,a,n){return a.replace(r,"$&,")+n})}return e},percentage:e=>Q(e)?`${Number(e)*100}%`:e},at=[{field:"checkbox",type:"checkbox",width:50,align:"center",fixed:"left"},{type:"seq",title:"序号",width:60},{field:"code",title:"编码"},{field:"name",title:"名称"},{field:"userCount",title:"用户数"},{field:"statusName",title:"状态",slots:{default:"data_status"}},{field:"modifiedBy",title:"修改人"},{field:"modifiedOn",title:"修改时间",width:100,formatter({cellValue:e}){return ot.date(e)}},{title:"操作",align:"center",width:180,fixed:"right",slots:{default:"operations"}}],lt={items:[{field:"code",span:3,folding:!1,slots:{default:"search_code"}},{field:"name",span:3,folding:!1,slots:{default:"search_name"}},{field:"status",span:3,folding:!1,slots:{default:"search_status"}},{field:"modifiedBy",span:3,folding:!0,slots:{default:"search_modifiedBy"}},{field:"modifiedOn",span:3,folding:!0,slots:{default:"search_modifiedOn"}},{collapseNode:!0,itemRender:{},slots:{default:"search_operation"}}]},st=V({name:"UserRole"}),ft=V(P(N({},st),{setup(e){const o=S(),t=de(),r=S(!1),{gridObject:l,gridOptions:s,getSelectedRows:a,refreshTable:n}=et({ref:o,gridKey:"GRID-USER-ROLE",getListApi:ze,columns:at,searchFormConfig:lt,cacheSearch:!0}),i=m=>{r.value=!0,l.currentRow=m},c=()=>{const m=a();t.info(JSON.stringify(m))};return(m,y)=>{const v=se,g=ie,f=re,R=je,x=Ie,U=He,I=Ve("perm");return h(),w(U,null,{default:u(()=>{var k;return[_(x,Z(d(s),{ref_key:"oGridRef",ref:o}),{search_code:u(({data:p})=>[_(v,{modelValue:p.code,"onUpdate:modelValue":b=>p.code=b,placeholder:"编码"},null,8,["modelValue","onUpdate:modelValue"])]),search_name:u(({data:p})=>[_(v,{modelValue:p.name,"onUpdate:modelValue":b=>p.name=b,placeholder:"名称"},null,8,["modelValue","onUpdate:modelValue"])]),search_status:u(({data:p})=>[_(g,{type:"USER_ROLE_STATUS",modelValue:p.status,"onUpdate:modelValue":b=>p.status=b,placeholder:"状态",clearable:""},null,8,["modelValue","onUpdate:modelValue"])]),search_modifiedBy:u(({data:p})=>[_(v,{modelValue:p.modifiedBy,"onUpdate:modelValue":b=>p.modifiedBy=b,placeholder:"修改人"},null,8,["modelValue","onUpdate:modelValue"])]),search_modifiedOn:u(({data:p})=>[_(v,{modelValue:p.modifiedOn,"onUpdate:modelValue":b=>p.modifiedOn=b,placeholder:"修改时间"},null,8,["modelValue","onUpdate:modelValue"])]),search_operation:u(()=>[_(f,{type:"primary","native-type":"submit"},{default:u(()=>[E("搜索")]),_:1}),_(f,{type:"primary",link:"","native-type":"reset"},{default:u(()=>[E("重置")]),_:1})]),toolbar_buttons:u(()=>[_(f,{type:"primary",onClick:c},{default:u(()=>[E("获取勾选")]),_:1})]),data_status:u(({row:p})=>[_(R,{type:"USER_ROLE_STATUS",value:p.status},null,8,["value"])]),operations:u(({row:p})=>[ae((h(),w(f,{type:"primary",link:"",onClick:b=>i(p)},{default:u(()=>[E(" 编辑 ")]),_:2},1032,["onClick"])),[[I,["user-role:update"]]])]),_:1},16),_(We,{modelValue:d(r),"onUpdate:modelValue":y[0]||(y[0]=p=>xe(r)?r.value=p:null),"data-id":`${(k=d(l).currentRow)==null?void 0:k.id}`,onRefresh:d(n)},null,8,["modelValue","data-id","onRefresh"])]}),_:1})}}}));export{ft as default};
